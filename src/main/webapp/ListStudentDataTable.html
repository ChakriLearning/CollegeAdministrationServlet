<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student List Table</title>
    <style>
        /* CSS styles for the table and its rows */
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #f61284;
        }

        tr:hover {
            background-color: #80ecd8; /* Change background color on hover */
        }

        /* CSS styles for the table header */
        th {
            background-color: #4CAF50; /* Green */
            color: #030000;
        }
    </style>
</head>
<body>
<a href="AddStudentData.html"><h3>Add New Student</h3></a>
<!--creating the div elements with id attribute ='student-list' used to display the list-->
<div id="student-list"></div>

<script>
    fetch('http://localhost:8081/CollegeAdministrationServlet/student')
        .then(response => response.json())  //get json data from the server's response
        .then(data => {//actual json data we received from the server
            let studentListDiv = document.getElementById('student-list');

            // Creating a table element dynamically;
            let table = document.createElement('table');
            table.border = "1";

            //
            // Creating  table header dynamically
            let thead = document.createElement('thead');
            //creating the table row;
            let headerRow = document.createElement('tr');
           // printing table head,column
            headerRow.innerHTML = `
                    <th>RollNo</th>
                    <th>Name</th>
                    <th>Age</th>
                    <th>PhoneNo</th>
                    <th>Actions</th>
                `;
            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Create table body
            let tbody = document.createElement('tbody');
            data.forEach(student => {
                let row = document.createElement('tr');
                row.innerHTML = `
                        <td>${student.rollNo}</td>
                        <td>${student.name}</td>
                        <td>${student.age}</td>
                        <td>${student.phoneNo}</td>
                         <td>
        <a href="UpdateStudentData.html?rollNo=${student.rollNo}&name=${student.name}&age=${student.age}&phoneNo=${student.phoneNo}">Edit</a> |
       <a href="#" class="delete-link" data-rollno="${student.rollNo}" data-name="${student.name}" data-age="${student.age}" data-phoneNo="${student.phoneNo}">Delete</a> |
        <a href="GetStudentData.html?rollNo=${student.rollNo}">View</a>
    </td>
<!--                        <td><a href="DeleteStudentData.html">Delete</a></td>-->
                    `;
                tbody.appendChild(row);  //appending each row to <tbody> element
            });
            table.appendChild(tbody); //appending all the row's to the <table>

            // Append the table to the student list div
            studentListDiv.appendChild(table);
            // Add event listeners for delete links
            document.querySelectorAll('.delete-link').forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    const rollNo = this.getAttribute('data-rollno');
                    const name = this.getAttribute('data-name');
                    const age = this.getAttribute('data-age');
                    const phoneNo = this.getAttribute('data-phoneNo');
                    if (confirm(`Are you sure you want to delete student with Roll No : ${rollNo}.    having   Name : ${name}    age : ${age}   phoneNo : ${phoneNo}`)) {
                        window.location.href ="DeleteStudentData.html?rollNo="+rollNo;
                    }
                });
            });
        })
        .catch(error => console.error('Error fetching JSON data:', error));
</script>
</body>
</html>
